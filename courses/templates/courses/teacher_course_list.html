{% extends "base.html" %}
{% block title %}Manage Courses{% endblock %}

{% block content %}

<div class="container" style="max-width:1100px;margin:auto;">

  <h2>ğŸ“š Manage Courses</h2>

  <!-- CREATE COURSE -->
  <div style="margin:15px 0;">
    <a class="btn btn-primary"
       href="{% url 'courses:course_create' %}">
       â• Create Course
    </a>
  </div>

  <hr>

  {% for c in courses %}
  <div style="
      border:1px solid #e5e7eb;
      border-radius:12px;
      padding:15px;
      margin-bottom:12px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      flex-wrap:wrap;
      gap:12px;
  ">

    <!-- ================= LEFT INFO ================= -->
    <div style="min-width:260px;">
      <strong style="font-size:17px;">
        {{ c.title }}
      </strong>

      <div style="color:#6b7280;margin-top:4px;">
        Subject: {{ c.subject.name }}
      </div>

      <div style="margin-top:6px;">
        {% if c.is_published %}
          <span style="color:green;font-weight:600;">
            âœ… Published (Visible on Prices Page)
          </span>
        {% else %}
          <span style="color:#b45309;font-weight:600;">
            Hidden from Students
          </span>
        {% endif %}
      </div>
    </div>


    <!-- ================= ACTION BUTTONS ================= -->
    <div style="
        display:flex;
        gap:8px;
        flex-wrap:wrap;
        justify-content:flex-end;
        align-items:center;
    ">

      <!-- VIEW COURSE -->
      <!-- <a class="btn btn-secondary"
         href="{% url 'courses:course_dashboard' c.id %}">
         ğŸ‘ View
      </a> -->

      <!-- VISIBILITY CONTROL -->
      <a class="btn btn-secondary"
         href="{% url 'courses:manage_course_visibility' c.id %}">
         ğŸ” Visibility
      </a>

      <!-- ADD LESSON -->
      <a class="btn btn-secondary"
         href="{% url 'courses:lesson_create' c.id %}">
         â• Lesson
      </a>

      <!-- EDIT COURSE -->
      <a class="btn btn-secondary"
         href="{% url 'courses:course_edit' c.id %}">
         âœ Edit
      </a>

      <!-- DELETE COURSE -->
      <form method="post"
            action="{% url 'courses:course_delete' c.id %}"
            onsubmit="return confirm('Delete this course?');">
        {% csrf_token %}
        <button class="btn btn-danger">
          ğŸ—‘ Delete
        </button>
      </form>

      <!-- PUBLISH / HIDE -->
      <form method="post"
            action="{% url 'courses:course_toggle_publish' c.id %}">
        {% csrf_token %}

        {% if c.is_published %}
          <button type="submit" class="btn btn-secondary">
            Hide
          </button>
        {% else %}
          <button type="submit" class="btn btn-primary">
            Publish
          </button>
        {% endif %}
      </form>

    </div>

  </div>

  {% empty %}
    <p>No courses created yet.</p>
  {% endfor %}

</div>

{% endblock %}