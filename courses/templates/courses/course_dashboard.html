{% extends "base.html" %}
{% block content %}

<div style="max-width:900px;margin:auto;">

  <!-- COURSE HEADER -->
  <h2>{{ course.title }}</h2>

  {% if course.overview %}
    <p style="color:#6b7280;">{{ course.overview }}</p>
  {% endif %}

  <!-- CONTINUE LEARNING -->
  {% if next_lesson %}
    <a class="btn btn-primary"
       href="{% url 'courses:lesson_detail' course.id next_lesson.id %}">
       ▶ Continue Learning
    </a>
  {% endif %}

  <hr>

  <!-- PROGRESS BAR -->
  <div style="height:10px;background:#e5e7eb;border-radius:6px;">
    <div style="
        height:10px;
        width:{{ progress.percent }}%;
        background:#2563eb;
        border-radius:6px;">
    </div>
  </div>

  <p>
    <strong>{{ progress.done }}</strong> /
    <strong>{{ progress.total }}</strong>
    lessons completed ({{ progress.percent }}%)
  </p>

  {% if progress.percent >= 100 %}
      <span style="color:green;font-weight:bold;">
        ✅ Course Completed
      </span>
  {% else %}
      <span style="color:#6b7280;">In Progress</span>
  {% endif %}

  <hr>

  <!-- LESSON LIST -->
  <h3>Lessons</h3>

  {% for r in rows %}
    <div style="
        display:flex;
        justify-content:space-between;
        padding:10px;
        border-bottom:1px solid #eee;">

      <div>
        {% if r.done %}✅{% else %}⬜{% endif %}
        <strong>{{ r.lesson.title }}</strong>
      </div>

      <div>
        <a class="btn btn-secondary"
           href="{% url 'courses:lesson_detail' course.id r.lesson.id %}">
           Open
        </a>

        <a class="btn btn-secondary"
           href="{% url 'courses:lesson_quiz' course.id r.lesson.id %}">
           Quiz
        </a>
      </div>

    </div>
  {% empty %}
    <p>No lessons available.</p>
  {% endfor %}

</div>

{% endblock %}